<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload PDF dari Google Drive</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .upload-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 30px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        .form-title {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
        }
        .form-group label {
            font-weight: 600;
            color: #555;
        }
        .form-control:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0,123,255,.25);
        }
        .btn-primary {
            background-color: #007bff;
            border-color: #007bff;
        }
        .btn-primary:hover {
            background-color: #0069d9;
            border-color: #0062cc;
        }
        .preview-container {
            margin-top: 30px;
            padding: 20px;
            border: 1px dashed #ddd;
            border-radius: 5px;
            display: none;
        }
        .preview-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }
        .info-box {
            background-color: #e7f3fe;
            border-left: 6px solid #2196F3;
            margin-bottom: 20px;
            padding: 15px;
        }
        .step-guide {
            margin-top: 30px;
        }
        .step-guide h5 {
            color: #007bff;
            margin-bottom: 15px;
        }
        .step-guide ol {
            padding-left: 20px;
        }
        .step-guide li {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top shadow-sm">
        <a class="navbar-brand" href="index.html">
            <img src="images/logo.png" alt="KPK LOGO" width="150">
        </a>
    </nav>

    <div class="upload-container">
        <h2 class="form-title">Upload PDF dari Google Drive</h2>
        
        <div class="info-box">
            <p><i class="fas fa-info-circle"></i> Gunakan form ini untuk menampilkan PDF dari Google Drive di website Anda.</p>
        </div>

        <form id="uploadForm">
            <div class="form-group">
                <label for="pdfTitle">Judul Dokumen</label>
                <input type="text" class="form-control" id="pdfTitle" placeholder="Masukkan judul dokumen" required>
            </div>
            
            <div class="form-group">
                <label for="pdfAuthor">Penulis</label>
                <input type="text" class="form-control" id="pdfAuthor" placeholder="Masukkan nama penulis">
            </div>
            
            <div class="form-group">
                <label for="pdfDate">Tanggal</label>
                <input type="date" class="form-control" id="pdfDate">
            </div>
            
            <div class="form-group">
                <label for="pdfSize">Ukuran File (dalam MB)</label>
                <input type="text" class="form-control" id="pdfSize" placeholder="Contoh: 2.5">
            </div>
            
            <div class="form-group">
                <label for="pdfDescription">Deskripsi</label>
                <textarea class="form-control" id="pdfDescription" rows="3" placeholder="Masukkan deskripsi singkat tentang dokumen"></textarea>
            </div>
            
            <div class="form-group">
                <label for="googleDriveLink">Link Google Drive PDF</label>
                <input type="url" class="form-control" id="googleDriveLink" placeholder="https://drive.google.com/file/d/FILE_ID/view" required>
                <small class="form-text text-muted">Paste link sharing dari Google Drive</small>
            </div>
            
            <div class="form-group">
                <label for="thumbnailLink">Link Thumbnail (Opsional)</label>
                <input type="url" class="form-control" id="thumbnailLink" placeholder="https://example.com/image.jpg">
                <small class="form-text text-muted">Link gambar untuk thumbnail, kosongkan jika tidak ada</small>
            </div>
            
            <button type="submit" class="btn btn-primary btn-block">Generate Link PDF</button>
        </form>
        
        <div class="preview-container" id="previewContainer">
            <h4 class="preview-title">Preview Dokumen</h4>
            <div class="card">
                <div class="row no-gutters">
                    <div class="col-md-3">
                        <img id="previewThumbnail" src="https://via.placeholder.com/150x200?text=No+Image" class="w-100" alt="Thumbnail">
                    </div>
                    <div class="col-md-9">
                        <div class="card-body">
                            <h5 class="card-title" id="previewTitle">Judul Dokumen</h5>
                            <p class="card-text">
                                <small class="text-muted" id="previewAuthor">Penulis</small> | 
                                <small class="text-muted" id="previewDate">Tanggal</small>
                            </p>
                            <p class="card-text">
                                <i class="fas fa-file"></i> File Size: <span id="previewSize">Ukuran File</span>
                            </p>
                            <p class="card-text" id="previewDescription">Deskripsi</p>
                            <a href="#" id="previewLink" class="btn btn-primary" target="_blank">Buka PDF</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-3">
                <button id="copyLinkBtn" class="btn btn-outline-primary">
                    <i class="fas fa-copy"></i> Salin Link
                </button>
                <button id="openFlipbookBtn" class="btn btn-success">
                    <i class="fas fa-book-open"></i> Buka di Flipbook
                </button>
            </div>
        </div>
        
        <div class="step-guide">
            <h5>Cara Mendapatkan Link Sharing Google Drive:</h5>
            <ol>
                <li>Buka Google Drive dan cari file PDF yang ingin Anda bagikan</li>
                <li>Klik kanan pada file tersebut</li>
                <li>Pilih "Bagikan" atau "Share"</li>
                <li>Klik "Dapatkan link" atau "Get link"</li>
                <li>Ubah setting dari "Terbatas" menjadi "Siapa pun yang memiliki link"</li>
                <li>Salin link yang muncul</li>
                <li>Paste link tersebut ke form di atas</li>
            </ol>
        </div>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    
    <script>
        $(document).ready(function() {
            // Set today's date as default
            const today = new Date().toISOString().split('T')[0];
            $('#pdfDate').val(today);
            
            // Handle form submission
            $('#uploadForm').on('submit', function(e) {
                e.preventDefault();
                
                // Get form values
                const title = $('#pdfTitle').val();
                const author = $('#pdfAuthor').val();
                const date = $('#pdfDate').val();
                const size = $('#pdfSize').val();
                const description = $('#pdfDescription').val();
                const driveLink = $('#googleDriveLink').val();
                const thumbnailLink = $('#thumbnailLink').val();
                
                // Extract file ID from Google Drive link
                let fileId = '';
                const patterns = [
                    /\/file\/d\/([a-zA-Z0-9_-]+)/,
                    /id=([a-zA-Z0-9_-]+)/,
                    /\/open\?id=([a-zA-Z0-9_-]+)/
                ];
                
                for (const pattern of patterns) {
                    const match = driveLink.match(pattern);
                    if (match && match[1]) {
                        fileId = match[1];
                        break;
                    }
                }
                
                if (!fileId) {
                    alert('Link Google Drive tidak valid. Silakan periksa kembali.');
                    return;
                }
                
                // Create direct link to PDF
                const directLink = `https://drive.google.com/uc?export=view&id=${fileId}`;
                
                // Update preview
                $('#previewTitle').text(title);
                $('#previewAuthor').text(author || 'Tidak diketahui');
                $('#previewDate').text(date ? new Date(date).toLocaleDateString('id-ID') : 'Tidak diketahui');
                $('#previewSize').text(size ? `${size} MB` : 'Tidak diketahui');
                $('#previewDescription').text(description || 'Tidak ada deskripsi');
                $('#previewLink').attr('href', directLink);
                
                // Update thumbnail if provided
                if (thumbnailLink) {
                    $('#previewThumbnail').attr('src', thumbnailLink);
                } else {
                    $('#previewThumbnail').attr('src', 'https://via.placeholder.com/150x200?text=No+Image');
                }
                
                // Show preview container
                $('#previewContainer').show();
                
                // Store data in localStorage for flipbook page
                localStorage.setItem('pdfData', JSON.stringify({
                    title,
                    author,
                    date,
                    size,
                    description,
                    pdfUrl: directLink,
                    thumbnailUrl: thumbnailLink || 'https://via.placeholder.com/150x200?text=No+Image'
                }));
                
                // Scroll to preview
                $('html, body').animate({
                    scrollTop: $('#previewContainer').offset().top - 100
                }, 500);
            });
            
            // Copy link button
            $('#copyLinkBtn').on('click', function() {
                const pdfData = JSON.parse(localStorage.getItem('pdfData'));
                if (pdfData && pdfData.pdfUrl) {
                    // Create temporary input to copy to clipboard
                    const tempInput = $('<input>');
                    $('body').append(tempInput);
                    tempInput.val(pdfData.pdfUrl).select();
                    document.execCommand('copy');
                    tempInput.remove();
                    
                    // Show success message
                    const originalText = $(this).html();
                    $(this).html('<i class="fas fa-check"></i> Tersalin!');
                    setTimeout(() => {
                        $(this).html(originalText);
                    }, 2000);
                }
            });
            
            // Open flipbook button
            $('#openFlipbookBtn').on('click', function() {
                window.location.href = 'v-pdf-drive.html';
            });
        });
    </script>
</body>
</html>
